require=function e(t,n,c){function o(i,a){if(!n[i]){if(!t[i]){var s="function"==typeof require&&require;if(!a&&s)return s(i,!0);if(r)return r(i,!0);var h=new Error("Cannot find module '"+i+"'");throw h.code="MODULE_NOT_FOUND",h}var d=n[i]={exports:{}};t[i][0].call(d.exports,function(e){var n=t[i][1][e];return o(n?n:e)},d,d.exports,e,t,n,c)}return n[i].exports}for(var r="function"==typeof require&&require,i=0;i<c.length;i++)o(c[i]);return o}({backgroundLoader:[function(e,t,n){"use strict";cc._RF.push(t,"b877bKpUKpGHqroh11vogc0","backgroundLoader"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){var e="bg"+((100*Math.random()|0)%3+1),t=this.node.getComponent(cc.Sprite);cc.loader.loadRes("hero/"+e,cc.SpriteFrame,function(e,n){t.spriteFrame=n}),cc.log(e)}}),cc._RF.pop()},{}],btn:[function(e,t,n){"use strict";cc._RF.push(t,"f9706UdRQlCQqmR7kS5hHeX","btn");var c=e("landMaker");cc.Class({"extends":cc.Component,properties:{},onLoad:function(){},buttonClicked:function(){c.restart()},gameStart:function(){cc.director.loadScene("GameScene")}}),cc._RF.pop()},{landMaker:"landMaker"}],landMaker:[function(e,t,n){"use strict";cc._RF.push(t,"06ab0S0xsZDcpVTrYS0ee/A","landMaker");var c=e("spriteCreator"),o=e("perfectLabel"),r=e("storageManager"),i=new StateMachine({data:{gameDirector:null},init:"stand",transitions:[{name:"stickLengthen",from:"stand",to:"stickLengthened"},{name:"heroTick",from:"stickLengthened",to:"heroTicked"},{name:"stickFall",from:"heroTicked",to:"stickFalled"},{name:"heroMoveToLand",from:"stickFalled",to:"heroMovedToLand"},{name:"landMove",from:"heroMovedToLand",to:"stand"},{name:"heroMoveToStickEnd",from:"stickFalled",to:"heroMovedToStickEnd"},{name:"heroDown",from:"heroMovedToStickEnd",to:"heroDowned"},{name:"gameOver",from:"heroDowned",to:"end"},{name:"restart",from:"end",to:"stand"}],methods:{onLeaveHeroTicked:function(){a.unregisterEvent()},onStickLengthen:function(){a.gezi.node.active=!1,a.stickLengthen=!0,a.stick=a.createStick(),a.stick.x=a.hero.x+a.hero.width*(1-a.hero.anchorX)+a.stick.width*a.stick.anchorX;var e=a.hero.getComponent(cc.Animation);e.play("heroPush")},onHeroTick:function(){a.stickLengthen=!1;var e=a.hero.getComponent(cc.Animation);e.play("heroTick")},onStickFall:function(){var e=cc.rotateBy(.5,90);e.easing(cc.easeIn(3));var t=cc.callFunc(function(){var e=a.stick.height-a.stick.width*a.stick.anchorX;if(e<a.currentLandRange||e>a.currentLandRange+a.secondLand.width)i.heroMoveToStickEnd();else if(i.heroMoveToLand(),e>a.currentLandRange+a.secondLand.width/2-5&&e<a.currentLandRange+a.secondLand.width/2+5){a.perfect++,a.getScore(a.perfect);var t=a.perfectLabel.getComponent(o);t.showPerfect(a.perfect)}else a.perfect=0}),n=cc.sequence(e,t);a.stick.runAction(n)},onHeroMoveToLand:function(){var e=a.hero.getComponent(cc.Animation),t=cc.callFunc(function(){e.stop("heroRun"),a.getScore(),i.landMove()});e.play("heroRun"),a.heroMove(a.hero,{length:a.currentLandRange+a.secondLand.width,callFunc:t})},onLandMove:function(){var e=cc.callFunc(function(){a.registerEvent(),a.gezi.node.active=!0,a.gezi.string="东哥放了你1次鸽子\n并且约你去前面见面"});a.landCreateAndMove(e)},onHeroMoveToStickEnd:function(){var e=a.hero.getComponent(cc.Animation),t=cc.callFunc(function(){e.stop("heroRun"),i.heroDown(),a.gezi.node.active=!1});e.play("heroRun"),a.heroMove(a.hero,{length:a.stick.height,callFunc:t})},onHeroDown:function(){var e=cc.callFunc(function(){i.gameOver()});a.stickAndHeroDownAction(e)},onGameOver:function(){a.overLabel.node.active=!0,a.overLabel2.node.active=!0;var e=a.score+1;a.overLabel2.string="你没有见到东鸽 \n并且被东鸽\n放鸽子"+e+"次"},onRestart:function(){cc.director.loadScene("GameScene")}}}),a=null;cc.Class({"extends":cc.Component,properties:{landRange:cc.v2(20,300),landWidth:cc.v2(20,200),hero:cc.Node,firstLand:cc.Node,secondLand:cc.Node,moveDuration:.5,stickSpeed:400,heroMoveSpeed:400,stickWidth:6,canvas:cc.Node,scoreLabel:cc.Label,hightestScoreLabel:cc.Label,overLabel:cc.Label,overLabel2:cc.Label,gezi:cc.Label,perfectLabel:cc.Node},onLoad:function(){a=this,this.runLength=0,this.stick=null,this.stickLengthen=!1,this.score=0,this.perfect=0,this.currentLandRange=0,this.heroWorldPosX=0,this.changeHightestScoreLabel(),this.gezi.node.active=!0,this.gezi.string="东鸽约你去前面见面\n快去吧骚年！",this.createNewLand();var e=this.getLandRange();this.heroWorldPosX=this.firstLand.width-(1-this.hero.anchorX)*this.hero.width-this.stickWidth,this.secondLand.setPosition(e+this.firstLand.width,0),this.registerEvent();var t=a.hero.getComponent(cc.Animation);t.on("stop",function(e){"heroTick"==e.target.name&&i.stickFall()})},registerEvent:function(){this.canvas.on(cc.Node.EventType.TOUCH_START,this.touchStart.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_END,this.touchEnd.bind(this),this.node),this.canvas.on(cc.Node.EventType.TOUCH_CANCEL,this.touchCancel.bind(this),this.node),console.log("on")},unregisterEvent:function(){this.canvas.targetOff(this.node),console.log("off")},update:function(e){this.stickLengthen&&(this.stick.height+=e*this.stickSpeed)},touchStart:function(e){i.stickLengthen(),cc.log("touchStart")},touchEnd:function(e){i.heroTick(),cc.log("touchEnd")},touchCancel:function(){this.touchEnd(),cc.log("touchCancel")},stickAndHeroDownAction:function(e){var t=cc.rotateBy(.5,90);t.easing(cc.easeIn(3)),this.stick.runAction(t);var n=cc.moveBy(.5,cc.p(0,-300-this.hero.height));n.easing(cc.easeIn(3));var c=cc.sequence(n,e);this.hero.runAction(c)},heroMove:function s(e,t){var n=t.length/this.heroMoveSpeed,s=cc.moveBy(n,cc.p(t.length,0));if(t.callFunc){var c=cc.sequence(s,t.callFunc);this.hero.runAction(c)}else this.hero.runAction(s)},landCreateAndMove:function(e){var t=cc.director.getWinSize(),n=this.currentLandRange+this.secondLand.width;this.runLength+=n;var c=cc.moveBy(this.moveDuration,cc.p(-n,0));this.node.runAction(c),this.firstLand=this.secondLand,this.createNewLand();var o=this.getLandRange();this.secondLand.setPosition(this.runLength+t.width,0);var r=t.width-o-this.heroWorldPosX-this.hero.width*this.hero.anchorX-this.stickWidth,i=cc.moveBy(this.moveDuration,cc.p(-r,0)),a=cc.sequence(i,e);this.secondLand.runAction(a)},createStick:function(){cc.log("sc");var e=c.createStick(this.stickWidth);return e.parent=this.node,e},createNewLand:function(){this.secondLand=c.createNewLand(this.getLandWidth()),this.secondLand.parent=this.node},getScore:function(e){e?this.score+=e:this.score++,r.getHighestScore()<this.score&&(r.setHighestScore(this.score),this.changeHightestScoreLabel()),this.scoreLabel.string="得分:"+this.score},changeHightestScoreLabel:function(){this.hightestScoreLabel.string="最高分:"+r.getHighestScore()},getLandRange:function(){this.currentLandRange=this.landRange.x+(this.landRange.y-this.landRange.x)*Math.random();var e=cc.director.getWinSize();return e.width<this.currentLandRange+this.heroWorldPosX+this.hero.width+this.secondLand.width&&(this.currentLandRange=e.width-this.heroWorldPosX-this.hero.width-this.secondLand.width),this.currentLandRange},getLandWidth:function(){return this.landWidth.x+(this.landWidth.y-this.landWidth.x)*Math.random()}}),t.exports=i,cc._RF.pop()},{perfectLabel:"perfectLabel",spriteCreator:"spriteCreator",storageManager:"storageManager"}],perfectLabel:[function(e,t,n){"use strict";cc._RF.push(t,"39827GFyPRNJbWrKz6ShGhU","perfectLabel"),cc.Class({"extends":cc.Component,properties:{},onLoad:function(){this.anim=this.node.getComponent(cc.Animation),this.label=this.node.getComponent(cc.Label)},showPerfect:function(e){this.label.string="Perfect x"+e;var t=cc.fadeIn(.1),n=cc.moveBy(1,cc.p(0,0)),c=cc.fadeOut(0),o=cc.sequence(t,n,c);this.node.runAction(o)},removeLabel:function(){cc.log("removeLabel")},showLabel:function(){cc.log("showLabel")}}),cc._RF.pop()},{}],spriteCreator:[function(e,t,n){"use strict";cc._RF.push(t,"fac0cFOzGJKMaEGKF/+6AMU","spriteCreator");var c=function(){var e=null;return{createNewLand:function(t){var n=new cc.Node("Land");n.anchorX=0,n.anchorY=0;var c=n.addComponent(cc.Sprite);c.sizeMode=cc.Sprite.SizeMode.CUSTOM,n.color=cc.Color.BLACK,n.height=300,n.width=t;var o=new cc.Node("Red Land");o.anchorY=1;var r=o.addComponent(cc.Sprite);return r.sizeMode=cc.Sprite.SizeMode.CUSTOM,o.color=cc.Color.RED,o.parent=n,o.height=10,o.width=10,o.setPosition(n.width/2,n.height),e?(c.spriteFrame=e,r.spriteFrame=e):cc.loader.loadRes("hero/blank",cc.SpriteFrame,function(t,n){c.spriteFrame=n,r.spriteFrame=n,e=n}),n.center=o,n},createStick:function(t){var n=new cc.Node("stick");n.anchorY=0,n.y=300;var c=n.addComponent(cc.Sprite);return c.sizeMode=cc.Sprite.SizeMode.CUSTOM,c.spriteFrame=e,n.color=cc.Color.BLACK,n.width=t,n.height=0,n}}}();t.exports=c,cc._RF.pop()},{}],storageManager:[function(e,t,n){"use strict";cc._RF.push(t,"333dfNuUoxPM6skEF3RI/C3","storageManager");var c=function(){return cc.sys.localStorage.highestScore||(cc.sys.localStorage.highestScore=0),{getHighestScore:function(){return cc.sys.localStorage.highestScore},setHighestScore:function(e){cc.sys.localStorage.highestScore=e}}}();t.exports=c,cc._RF.pop()},{}]},{},["backgroundLoader","btn","landMaker","perfectLabel","spriteCreator","storageManager"]);